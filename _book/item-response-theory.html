<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 11 Item Response Theory | How to calibrate protection vulnerability scoring?</title>
  <meta name="description" content="Hands-on tutorials to calibrate vulnerability scores" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content=" 11 Item Response Theory | How to calibrate protection vulnerability scoring?" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="media/image_protect.jpg" />
  <meta property="og:description" content="Hands-on tutorials to calibrate vulnerability scores" />
  <meta name="github-repo" content="unhcr-americas/vulnerability-scoring" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 11 Item Response Theory | How to calibrate protection vulnerability scoring?" />
  
  <meta name="twitter:description" content="Hands-on tutorials to calibrate vulnerability scores" />
  <meta name="twitter:image" content="media/image_protect.jpg" />

<meta name="author" content="Field experience stocktaking - UNHCR" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="media/favicon.ico" type="image/x-icon" />
<link rel="prev" href="data-envelopment-and-deprivation.html"/>
<link rel="next" href="robustness-and-sensitivity-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">How to calibrate protection vulnerability scoring?</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="executive-summary-what-you-need-to-know-as-a-manager.html"><a href="executive-summary-what-you-need-to-know-as-a-manager.html"><i class="fa fa-check"></i><b>2</b> Executive summary: what you need to know as a manager</a><ul>
<li class="chapter" data-level="2.1" data-path="executive-summary-what-you-need-to-know-as-a-manager.html"><a href="executive-summary-what-you-need-to-know-as-a-manager.html#theres-no-simple-solution-to-complex-problem"><i class="fa fa-check"></i><b>2.1</b> There’s no simple solution to complex problem</a></li>
<li class="chapter" data-level="2.2" data-path="executive-summary-what-you-need-to-know-as-a-manager.html"><a href="executive-summary-what-you-need-to-know-as-a-manager.html#scoring-with-a-protection-lens"><i class="fa fa-check"></i><b>2.2</b> Scoring with a protection lens</a></li>
<li class="chapter" data-level="2.3" data-path="executive-summary-what-you-need-to-know-as-a-manager.html"><a href="executive-summary-what-you-need-to-know-as-a-manager.html#the-reliability-of-your-scores-will-reflect-the-quality-of-your-data"><i class="fa fa-check"></i><b>2.3</b> The reliability of your scores will reflect the quality of your data</a></li>
<li class="chapter" data-level="2.4" data-path="executive-summary-what-you-need-to-know-as-a-manager.html"><a href="executive-summary-what-you-need-to-know-as-a-manager.html#be-ready-for-auditing"><i class="fa fa-check"></i><b>2.4</b> Be ready for auditing</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="why-and-when-using-vulnerability-scoring.html"><a href="why-and-when-using-vulnerability-scoring.html"><i class="fa fa-check"></i><b>3</b> Why and when using vulnerability scoring?</a><ul>
<li class="chapter" data-level="3.1" data-path="why-and-when-using-vulnerability-scoring.html"><a href="why-and-when-using-vulnerability-scoring.html#from-the-identification-of-vulnerables-to-the-scoring-of-household-vulnerability"><i class="fa fa-check"></i><b>3.1</b> from the identification of vulnerables to the scoring of household vulnerability</a></li>
<li class="chapter" data-level="3.2" data-path="why-and-when-using-vulnerability-scoring.html"><a href="why-and-when-using-vulnerability-scoring.html#different-models-of-vulnerability-from-food-insecurity-poverty-to-a-protection-vulnerability-framework"><i class="fa fa-check"></i><b>3.2</b> Different models of vulnerability: from food insecurity &amp; poverty to a “protection vulnerability framework”</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="potential-approaches-to-calibrate-scores.html"><a href="potential-approaches-to-calibrate-scores.html"><i class="fa fa-check"></i><b>4</b> Potential approaches to calibrate scores</a><ul>
<li class="chapter" data-level="4.1" data-path="potential-approaches-to-calibrate-scores.html"><a href="potential-approaches-to-calibrate-scores.html#what-is-calibration"><i class="fa fa-check"></i><b>4.1</b> What is calibration?</a></li>
<li class="chapter" data-level="4.2" data-path="potential-approaches-to-calibrate-scores.html"><a href="potential-approaches-to-calibrate-scores.html#calibration-using-expert-opinions"><i class="fa fa-check"></i><b>4.2</b> Calibration using expert opinions</a></li>
<li class="chapter" data-level="4.3" data-path="potential-approaches-to-calibrate-scores.html"><a href="potential-approaches-to-calibrate-scores.html#calibration-using-statistically-representative-dataset"><i class="fa fa-check"></i><b>4.3</b> Calibration using statistically representative dataset</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="risks-when-calibrating-vulnerability-scores.html"><a href="risks-when-calibrating-vulnerability-scores.html"><i class="fa fa-check"></i><b>5</b> Risks when calibrating vulnerability scores</a><ul>
<li class="chapter" data-level="5.1" data-path="risks-when-calibrating-vulnerability-scores.html"><a href="risks-when-calibrating-vulnerability-scores.html#theres-no-magic-formula"><i class="fa fa-check"></i><b>5.1</b> There’s no magic formula</a></li>
<li class="chapter" data-level="5.2" data-path="risks-when-calibrating-vulnerability-scores.html"><a href="risks-when-calibrating-vulnerability-scores.html#building-consensus"><i class="fa fa-check"></i><b>5.2</b> Building consensus</a></li>
<li class="chapter" data-level="5.3" data-path="risks-when-calibrating-vulnerability-scores.html"><a href="risks-when-calibrating-vulnerability-scores.html#including-and-communication-with-communities"><i class="fa fa-check"></i><b>5.3</b> Including and communication with communities</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="budget-allocation.html"><a href="budget-allocation.html"><i class="fa fa-check"></i><b>6</b> Budget allocation</a><ul>
<li class="chapter" data-level="6.1" data-path="budget-allocation.html"><a href="budget-allocation.html#selecting-experts"><i class="fa fa-check"></i><b>6.1</b> Selecting experts</a></li>
<li class="chapter" data-level="6.2" data-path="budget-allocation.html"><a href="budget-allocation.html#speed-up-consultation-with-quadratic-voting"><i class="fa fa-check"></i><b>6.2</b> Speed-up consultation with quadratic voting</a></li>
<li class="chapter" data-level="6.3" data-path="budget-allocation.html"><a href="budget-allocation.html#restitution-of-results"><i class="fa fa-check"></i><b>6.3</b> Restitution of results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conjoint-analysis.html"><a href="conjoint-analysis.html"><i class="fa fa-check"></i><b>7</b> Conjoint analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="conjoint-analysis.html"><a href="conjoint-analysis.html#principle-of-opinion-reverse-engineering"><i class="fa fa-check"></i><b>7.1</b> Principle of opinion reverse engineering</a></li>
<li class="chapter" data-level="7.2" data-path="conjoint-analysis.html"><a href="conjoint-analysis.html#cutomise-the-indicators"><i class="fa fa-check"></i><b>7.2</b> Cutomise the indicators</a></li>
<li class="chapter" data-level="7.3" data-path="conjoint-analysis.html"><a href="conjoint-analysis.html#setting-up-the-consultation"><i class="fa fa-check"></i><b>7.3</b> Setting up the consultation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html"><i class="fa fa-check"></i><b>8</b> Analytic Hierarchy Process</a><ul>
<li class="chapter" data-level="8.1" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#defining-weights-through-expert-judgment"><i class="fa fa-check"></i><b>8.1</b> Defining weights through expert judgment</a></li>
<li class="chapter" data-level="8.2" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#use-case-with-the-scoring-of-vulnerabilities"><i class="fa fa-check"></i><b>8.2</b> Use case with the Scoring of vulnerabilities</a></li>
<li class="chapter" data-level="8.3" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#the-analytic-hierarchy-process-ahp"><i class="fa fa-check"></i><b>8.3</b> The Analytic Hierarchy Process (AHP)</a></li>
<li class="chapter" data-level="8.4" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#limitation-of-ahp"><i class="fa fa-check"></i><b>8.4</b> Limitation of AHP</a></li>
<li class="chapter" data-level="8.5" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#how-to-a-step-by-step-approach"><i class="fa fa-check"></i><b>8.5</b> How to? A step by step approach</a></li>
<li class="chapter" data-level="8.6" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#define-vulnerability-criteria"><i class="fa fa-check"></i><b>8.6</b> Define vulnerability criteria</a><ul>
<li class="chapter" data-level="8.6.1" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#criteria-without-hierarchy"><i class="fa fa-check"></i><b>8.6.1</b> Criteria without hierarchy</a></li>
<li class="chapter" data-level="8.6.2" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#criteria-with-hierarchy"><i class="fa fa-check"></i><b>8.6.2</b> Criteria with hierarchy</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#build-the-expert-consultation-form"><i class="fa fa-check"></i><b>8.7</b> Build the expert consultation form</a></li>
<li class="chapter" data-level="8.8" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#form"><i class="fa fa-check"></i><b>8.8</b> Form</a></li>
<li class="chapter" data-level="8.9" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#generate-the-ahp-file-from-the-collected-data"><i class="fa fa-check"></i><b>8.9</b> 3. Generate the AHP file from the collected data</a></li>
<li class="chapter" data-level="8.10" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#run-ahp-algorithm"><i class="fa fa-check"></i><b>8.10</b> 4. Run AHP algorithm</a></li>
<li class="chapter" data-level="8.11" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#review-results"><i class="fa fa-check"></i><b>8.11</b> 5. Review results</a></li>
<li class="chapter" data-level="8.12" data-path="analytic-hierarchy-process.html"><a href="analytic-hierarchy-process.html#apply-the-formula"><i class="fa fa-check"></i><b>8.12</b> 6. Apply the formula</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="vulnerability-proxy-regression.html"><a href="vulnerability-proxy-regression.html"><i class="fa fa-check"></i><b>9</b> Vulnerability proxy Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="vulnerability-proxy-regression.html"><a href="vulnerability-proxy-regression.html#section"><i class="fa fa-check"></i><b>9.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-envelopment-and-deprivation.html"><a href="data-envelopment-and-deprivation.html"><i class="fa fa-check"></i><b>10</b> Data Envelopment and Deprivation</a><ul>
<li class="chapter" data-level="10.1" data-path="data-envelopment-and-deprivation.html"><a href="data-envelopment-and-deprivation.html#what-is-deprivation-analysis"><i class="fa fa-check"></i><b>10.1</b> What is deprivation analysis?</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="item-response-theory.html"><a href="item-response-theory.html"><i class="fa fa-check"></i><b>11</b> Item Response Theory</a><ul>
<li class="chapter" data-level="11.1" data-path="item-response-theory.html"><a href="item-response-theory.html#vulnerability-as-a-latent-variable"><i class="fa fa-check"></i><b>11.1</b> Vulnerability as a “<em>latent</em>” variable</a></li>
<li class="chapter" data-level="11.2" data-path="item-response-theory.html"><a href="item-response-theory.html#building-composite-indicators-with-irt"><i class="fa fa-check"></i><b>11.2</b> Building composite indicators with IRT</a><ul>
<li class="chapter" data-level="11.2.1" data-path="item-response-theory.html"><a href="item-response-theory.html#step-0-data-preparation"><i class="fa fa-check"></i><b>11.2.1</b> Step 0: Data Preparation</a></li>
<li class="chapter" data-level="11.2.2" data-path="item-response-theory.html"><a href="item-response-theory.html#step-1-clustering-algorithm-dimensionality-assessment"><i class="fa fa-check"></i><b>11.2.2</b> Step 1: Clustering algorithm / Dimensionality assessment</a></li>
<li class="chapter" data-level="11.2.3" data-path="item-response-theory.html"><a href="item-response-theory.html#step-2-model-selection"><i class="fa fa-check"></i><b>11.2.3</b> Step 2: Model selection</a></li>
<li class="chapter" data-level="11.2.4" data-path="item-response-theory.html"><a href="item-response-theory.html#step-3-items-aggregation-using-the-weights"><i class="fa fa-check"></i><b>11.2.4</b> Step 3: Items aggregation using the weights</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="robustness-and-sensitivity-analysis.html"><a href="robustness-and-sensitivity-analysis.html"><i class="fa fa-check"></i><b>12</b> Robustness and Sensitivity analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="robustness-and-sensitivity-analysis.html"><a href="robustness-and-sensitivity-analysis.html#section-1"><i class="fa fa-check"></i><b>12.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="eligibility-and-prioritization.html"><a href="eligibility-and-prioritization.html"><i class="fa fa-check"></i><b>13</b> Eligibility and Prioritization</a><ul>
<li class="chapter" data-level="13.1" data-path="eligibility-and-prioritization.html"><a href="eligibility-and-prioritization.html#eligibility"><i class="fa fa-check"></i><b>13.1</b> Eligibility</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>14</b> Conclusion</a><ul>
<li class="chapter" data-level="14.1" data-path="conclusion.html"><a href="conclusion.html#section-2"><i class="fa fa-check"></i><b>14.1</b> </a></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://unhcr-americas.github.io/vulnerability-scoring/docs" target="blank">Source file</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">How to calibrate protection vulnerability scoring?</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="item-response-theory" class="section level1">
<h1><span class="header-section-number"> 11</span> Item Response Theory</h1>
<p>This tutorial is adapted from 2 articles:</p>
<ul>
<li><a href="https://arxiv.org/pdf/1210.5267.pdf">MultiLCIRT: An R package for multidimensional latent class item response models</a><br />
</li>
<li><a href="https://www.researchgate.net/profile/Simone_Del_Sarto/publication/303864920_Variable_weighting_via_multidimensional_IRT_models_in_Composite_Indicators_construction/links/575964c308aed884620ad4f0/Variable-weighting-via-multidimensional-IRT-models-in-Composite-Indicators-construction.pdf?origin=publication_detail">Variable weighting via multidimensional IRT models in Composite Indicators construction</a></li>
</ul>
<p>Thanks to <a href="delsarto@stat.unipg.it">Simone Del Sarto</a> from University of Perugia, Italy for the guidance on this document.</p>
<div id="vulnerability-as-a-latent-variable" class="section level2">
<h2><span class="header-section-number">11.1</span> Vulnerability as a “<em>latent</em>” variable</h2>
<p>A major task in the measurement of complex and latent household vulnerability dimensions phenomena such as deprivation (or <em>Basic Needs</em>), wealth (or <em>Coping capacity</em>) and ability (or <em>Well-being</em>) consists of <strong>summarising information</strong> available from a set of dichotomous or ordinal questions (also referred as <em>items</em>) from an household survey questionnaire. For example:</p>
<ul>
<li><p>Deprivation (or <em>Basic Needs</em>), is assessed by collecting data on the extent to which households possess certain commodities, engage in certain activities or are subject to financial pressures. The responses of individuals to deprivation item questionnaires constitute the manifest or observed indicators. (cf. <a href="https://www.researchgate.net/profile/Raileanu_Monica/publication/46452347_Item_response_theory_and_the_measurement_of_deprivation_Evidence_from_PSELL-3/links/00b4952a0e898e8b0d000000/Item-response-theory-and-the-measurement-of-deprivation-Evidence-from-PSELL-3.pdf?origin=publication_detail">Item response theory and the measurement of deprivation, Szeles and Fusco, 2013</a>)</p></li>
<li><p>Wealth (or <em>Coping capacity</em>) is a latent concept to be derived from observable assets, and measures of wealth are calculated from a set of assets a household possesses (cf. <a href="https://link.springer.com/article/10.1007/s11205-013-0447-z">Measuring Household Wealth with Latent Trait Modelling: An Application to Malawian DHS Data, Vandemoortele, 2014</a>).</p></li>
</ul>
</div>
<div id="building-composite-indicators-with-irt" class="section level2">
<h2><span class="header-section-number">11.2</span> Building composite indicators with IRT</h2>
<p>Item Response Theory (IRT) are specific type of statistical modeling that allows to address this complex challenge of building data-driven vulnerability scores without the use of proxy indicators. The assumptions that IRT approaches allows for are closer to the operational reality and needs:</p>
<ul>
<li><p>Latent phenomenon → not directly observable through a proxy, meaning that vulnerability is <strong>not directly measurable</strong> .</p>
<ul>
<li><p>Latent variable → assumed to have a <strong>discrete distribution</strong> rather than continuous vulnerability scales.</p></li>
<li><p>Phenomenon manifestation → <strong>response pattern</strong> to the items of a questionnaire rather to profile of respondents.</p></li>
<li><p>Summary of the phenomenon → <strong>composite indicators</strong> rather than predicted scores.</p></li>
</ul></li>
</ul>
<p>Item Response Theory (IRT) (also known as <em>latent trait theory</em>, <em>strong true score theory</em>, or <em>modern mental test theory</em>) is a paradigm for the design, analysis, and scoring of tests, questionnaires, and similar instruments measuring abilities, attitudes, or other latent variables. It is a theory of testing based on the relationship between individuals’ performances on a test item and the test takers’ levels of performance on an overall measure of the ability that item was designed to measure. IRT models the response of each respondant of a given ability to each item in the test.</p>
<p>The term <code>item</code>, here is generic, covering all kinds of informative items. They might be multiple choice questions that have incorrect and correct responses, but are also commonly statements on questionnaires that allow respondents to indicate level of agreement (a rating or Likert scale), or patient symptoms scored as present/absent, or diagnostic information in complex systems.</p>
<p>The main advantage of the <code>discrete</code> approach consists in the possibility of clustering the statistical units into homogeneous groups (latent classes): units (people, refugees and so on) in the same class share very similar characteristics in terms of the investigated (multidimensional) latent trait. Hence, this model would also allow us to classify refugees in similar groups. Such model can support prioritization needs as it assigns a score to each group, so that it is possible to highlight the most/least vulnerable groups of refugees and/or sketch several refugees’ profiles according to the various dimensions of it.</p>
<p>Composite indicators can be built using IRT using the following <strong>procedure</strong>:</p>
<ul>
<li>Step 1 : Assess dimensionality within the variables of the data-set → Multidimensional Latent Class IRT model + clustering algorithm
<ul>
<li>Step 2 : Adoption the best model for assigning weights to the test items. This steps also allows to account for dimensionality (clusters) within respondents.</li>
<li>Step 3 : Item aggregation using the weights obtained at the previous step → construction of a composite indicator for each dimension</li>
</ul></li>
</ul>
<div id="step-0-data-preparation" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Step 0: Data Preparation</h3>
<p>Data are loaded in a data frame and converted in a matrix, corresponding to the unit-by-unit response configurations.</p>
<p>To make the further estimation of the proposed models and clustering of items faster perform the analyses after aggregating the original records which correspond to the same response pattern so as to obtain a matrix with a record for each distinct response configuration (rather than for each statistical unit).</p>
<p>The function function <code>aggr_data</code> is then applied to this matrix. Output from function is:</p>
<ul>
<li><code>data_dis</code>: matrix of distinct configurations → S (used after in model estimation);
<ul>
<li><code>freq</code> : vector of corresponding frequencies → yv (used after in model estimation);<br />
</li>
<li><code>label</code>: index of each original response configuration among the distinct ones.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="item-response-theory.html#cb2-1"></a><span class="co">## Data from Bock &amp; Lieberman (1970); contains 5 dichotomously scored items obtained from the Law School Admissions Test, section 7.</span></span>
<span id="cb2-2"><a href="item-response-theory.html#cb2-2"></a><span class="co"># data(LSAT7)</span></span>
<span id="cb2-3"><a href="item-response-theory.html#cb2-3"></a><span class="co"># head(LSAT7)</span></span>
<span id="cb2-4"><a href="item-response-theory.html#cb2-4"></a><span class="co"># S &lt;- as.matrix(LSAT7[,1:5])</span></span>
<span id="cb2-5"><a href="item-response-theory.html#cb2-5"></a><span class="co"># yv &lt;- as.vector(LSAT7[,6])</span></span>
<span id="cb2-6"><a href="item-response-theory.html#cb2-6"></a></span>
<span id="cb2-7"><a href="item-response-theory.html#cb2-7"></a><span class="co">## dataset contains the responses of a sample of 1510 examinees to 12 binary items on Mathematics. It has been extrapolated from a larger dataset collected in 1996 by the Educational Testing Service within the National Assessment of Educational Progress (NAEP) project.</span></span>
<span id="cb2-8"><a href="item-response-theory.html#cb2-8"></a><span class="co">#data(naep)</span></span>
<span id="cb2-9"><a href="item-response-theory.html#cb2-9"></a></span>
<span id="cb2-10"><a href="item-response-theory.html#cb2-10"></a><span class="co">##  hads -&gt; Dataset about measurement of anxiety and depression in oncological patients. A data frame with 201 observations on 14 items, measuring depression or anxiety</span></span>
<span id="cb2-11"><a href="item-response-theory.html#cb2-11"></a>datadescription &lt;-<span class="st"> &quot;Dataset about measurement of anxiety and depression in oncological patients&quot;</span></span>
<span id="cb2-12"><a href="item-response-theory.html#cb2-12"></a><span class="kw">data</span>(hads)</span>
<span id="cb2-13"><a href="item-response-theory.html#cb2-13"></a><span class="co"># Convert to atrix</span></span>
<span id="cb2-14"><a href="item-response-theory.html#cb2-14"></a>data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(hads)</span>
<span id="cb2-15"><a href="item-response-theory.html#cb2-15"></a></span>
<span id="cb2-16"><a href="item-response-theory.html#cb2-16"></a><span class="co"># Prepare data</span></span>
<span id="cb2-17"><a href="item-response-theory.html#cb2-17"></a>out_aggr &lt;-<span class="st"> </span><span class="kw">aggr_data</span>(data)</span>
<span id="cb2-18"><a href="item-response-theory.html#cb2-18"></a>S &lt;-<span class="st"> </span>out_aggr<span class="op">$</span>data_dis</span>
<span id="cb2-19"><a href="item-response-theory.html#cb2-19"></a>yv &lt;-<span class="st"> </span>out_aggr<span class="op">$</span>freq</span>
<span id="cb2-20"><a href="item-response-theory.html#cb2-20"></a>labeldata &lt;-<span class="st"> </span>out_aggr<span class="op">$</span>label</span></code></pre></div>
<p>The data-set in this reports contains the responses of a sample of 201 / 201 records to 14 / 196 binary items.</p>
<p><a href="https://cran.r-project.org/web/packages/tabplot/vignettes/tabplot-vignette.html">Tableplot</a> is a powerful visualization method to explore and analyse large multivariate datasets. The representation below are used to help in the understanding of the data, explore the relationships between the variables, discover strange data patterns, and check the occurrence and selectivity of missing values.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="item-response-theory.html#cb3-1"></a><span class="co"># tableplot(hads,</span></span>
<span id="cb3-2"><a href="item-response-theory.html#cb3-2"></a><span class="co">#           # sortCol = unconditionnal2, </span></span>
<span id="cb3-3"><a href="item-response-theory.html#cb3-3"></a><span class="co">#            nBins = 200 , </span></span>
<span id="cb3-4"><a href="item-response-theory.html#cb3-4"></a><span class="co">#            fontsize = 10,</span></span>
<span id="cb3-5"><a href="item-response-theory.html#cb3-5"></a><span class="co">#            legend.lines = 8, </span></span>
<span id="cb3-6"><a href="item-response-theory.html#cb3-6"></a><span class="co">#            title = &quot;Overview of all indicators&quot;, </span></span>
<span id="cb3-7"><a href="item-response-theory.html#cb3-7"></a><span class="co">#            fontsize.title = 13)</span></span></code></pre></div>
</div>
<div id="step-1-clustering-algorithm-dimensionality-assessment" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Step 1: Clustering algorithm / Dimensionality assessment</h3>
<p>The first steps aims at grouping variables measuring the same latent construct in the same cluster</p>
<p>Investigating the best number of latent classes (parameter <code>k</code>) is done through Hierarchical clustering of items based on the Rasch model. The function <code>class_item</code> is used, it can take a long execution time. The classification is based on a sequence of likelihood ratio tests between pairs of multidimensional models suitably formulated.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="item-response-theory.html#cb4-1"></a>out &lt;-<span class="st"> </span><span class="kw">class_item</span>(S,</span>
<span id="cb4-2"><a href="item-response-theory.html#cb4-2"></a>                  yv,</span>
<span id="cb4-3"><a href="item-response-theory.html#cb4-3"></a>                  <span class="dt">k =</span> <span class="dv">3</span>, <span class="co"># latentclasses (partial output is omitted)</span></span>
<span id="cb4-4"><a href="item-response-theory.html#cb4-4"></a>                  <span class="dt">link =</span> <span class="dv">1</span>, <span class="co"># it is the same with link = 2</span></span>
<span id="cb4-5"><a href="item-response-theory.html#cb4-5"></a>                  <span class="dt">disc =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>The dendrogram below highlights three dimensions composing the multidimensional construct. Considering the item contents, the assessed dimension can be interpreted from a narrative point of view.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="item-response-theory.html#cb5-1"></a><span class="kw">plot</span>(out<span class="op">$</span>dend)</span></code></pre></div>
<p><img src="vulnerability-scoring_files/figure-html/dendogram-1.png" width="1152" /></p>
<p>The following tables allows to interpret the clustering:</p>
<ul>
<li><p>The first two columns (entitled <code>items</code>) indicate items or groups collapsed at each step of the clustering procedure,</p>
<ul>
<li><p>the third column(<code>deviance</code>) reports the corresponding LR statistic,</p></li>
<li><p>the fourth column(<code>df</code>)reports the number of degrees of freedom,</p></li>
<li><p>the fifth (<code>p-value</code>) reports the p-value, and</p></li>
<li><p>the last column (<code>newgroup</code>) contains the new group of items that is formed at each step.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="item-response-theory.html#cb6-1"></a><span class="co"># , results = &quot;asis&quot;</span></span>
<span id="cb6-2"><a href="item-response-theory.html#cb6-2"></a><span class="kw">summary</span>(out)</span></code></pre></div>
</div>
<div id="step-2-model-selection" class="section level3">
<h3><span class="header-section-number">11.2.3</span> Step 2: Model selection</h3>
<p>The second step is a selection procedure based on estimation of ordinal polytomous multidimensional LCIRT model. The formulation of a specific model in the class of multidimensional Latent Class (LC) IRT models univocally depends on:</p>
<ul>
<li>number of latent classes <code>k</code>,</li>
<li>adopted parameterization in terms of <code>link</code> function ,</li>
<li>constraints on the item parameters , and</li>
<li>number of latent dimensions (<code>s</code>) and the corresponding allocation of items within each dimension</li>
</ul>
<p>Parameter estimation for multidimensional IRT models based on discreteness of latent traits is performed through function <code>est_multi_poly</code> requires the following main input:</p>
<ul>
<li><p><code>S</code>: matrix of all response sequences observed at least once in the sample and listed row-by-row. Usually,S is a matrix of type data_dis obtained by applying function aggr_data to the original data. Missing responses are allowed and they are coded as NaN;</p>
<ul>
<li><p><code>yv</code>: vector of the frequencies of every response configuration in S corresponding to the output freq of function aggr_data (default value is given by a vector of ones, implying a unit weight for each record in S);</p></li>
<li><p><code>k</code> : number of latent classes - defined in the step 1;</p></li>
<li><p><code>X</code> : matrix of observed covariates, having the same dimension as S (default value is NULL, indicating the absence of covariates in the study);</p></li>
<li><p><code>start</code>: method of initialization of the algorithm: 0 ( = default value) for deterministic starting values, 1 for random starting values, and 2 for arguments given bytheuser. If start = 2 ,we also need to specify as input the initial values of weights, support points, and discriminating an ddifficulty item parameters (using additional input arguments that are set equal to NULL otherwise);</p></li>
<li><p><code>link</code> : type of link function: 0 (= default value) for the standard Latent Class model (i.e., no link function is specified),1 for global logits, and 2 for local logits. In the case of dichotomous responses, it is the same to specify link = 1 or link = 2;</p></li>
<li><p><code>disc</code> : indicator of constraints on the discriminating item parameters: 0 (= default value) if γj= 1, j=1 ,…, r, and 1 otherwise;</p></li>
<li><p><code>difl</code> : indicator of constraints on the difficulty item parameters: 0 (= default value) if difficulties are free and 1 if βjx= βj+ τx</p></li>
<li><p><code>multi</code> : matrix with a number of rows equal to the number of dimensions and elements in each row equal to the indices of the items measuring the dimension corresponding to that row. Cases where dimensions are measured by a different number of items are allowed, and the number of columns of matrix multi corresponds to the number of items in the largest dimension.</p></li>
</ul></li>
</ul>
<p>Function <code>est_multi_poly</code> supplies the following output:</p>
<ul>
<li><p><code>Piv</code>: optional object of type matrix containing the estimated weights of thelatent classes subject-by-subject (the weights may be different across subjects in the presence of covariates);</p></li>
<li><p><code>Th</code>: estimated matrix of ability levels (support points) for each dimension (= row of matrix Th) and latent class (= column of matrix Th);</p></li>
<li><p><code>Bec</code> : estimated vector of difficulty item parameters (split in two vectors if difl = 1);</p></li>
<li><p><code>gac</code> : estimated vector of discriminating item parameters; if disc = 0 (Rasch-type model), all values of vector gac are constrained to 1;</p></li>
<li><p><code>fv</code> : vector indicating the reference item chosen for each latent dimension;</p></li>
<li><p><code>Phi</code> : optional object of type array containing the conditional response probabilities (see Eq.(1)) for every item and latent class. The array is made of as many matrices as the latent classes; moreover, the j -th column of each of such matrices refers to item j , where as the x-th row of each matrix refers to the x- th responsecategory(x = 0,…, lj − 1) of item j. In the case of items differing in the number of response categories, zeros are included in the corresponding cells;</p></li>
<li><p><code>Pp</code> : optional object of type matrix containing the posterior probabilities of belonging to latent class c (column c of the Pp matrix), given the response configuration (row of the Pp matrix);</p></li>
<li><p><code>lk</code> : log-likelihood at convergence of the EM algorithm;</p></li>
<li><p><code>np</code> : number of free parameters;</p></li>
<li><p><code>aic</code> : Akaike Information Criterion index (Akaike,1973);</p></li>
<li><p><code>bic</code> : Bayesian Information Criterion index (Schwarz,1978)</p></li>
</ul>
<div id="number-latent-classes-to-consider" class="section level4">
<h4><span class="header-section-number">11.2.3.1</span> Number latent classes to consider</h4>
<p>Checking here the optimal value of parameter <code>k</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="item-response-theory.html#cb7-1"></a>oneclass &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S,yv,</span>
<span id="cb7-2"><a href="item-response-theory.html#cb7-2"></a>                       <span class="dt">k =</span> <span class="dv">1</span>, <span class="co"># number of ability levels (or latent classes)</span></span>
<span id="cb7-3"><a href="item-response-theory.html#cb7-3"></a>                       <span class="dt">start =</span> <span class="dv">0</span>, <span class="co"># method of initialization of the algorithm (0 = deterministic, 1 = random, 2 = arguments given as input)</span></span>
<span id="cb7-4"><a href="item-response-theory.html#cb7-4"></a>                       <span class="dt">link =</span> <span class="dv">0</span>) <span class="co"># type of link function (0 = no link function, 1 = global logits, 2 = local logits);</span></span>
<span id="cb7-5"><a href="item-response-theory.html#cb7-5"></a></span>
<span id="cb7-6"><a href="item-response-theory.html#cb7-6"></a>twoclass &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S,yv,</span>
<span id="cb7-7"><a href="item-response-theory.html#cb7-7"></a>                       <span class="dt">k =</span> <span class="dv">2</span>,</span>
<span id="cb7-8"><a href="item-response-theory.html#cb7-8"></a>                       <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb7-9"><a href="item-response-theory.html#cb7-9"></a>                       <span class="dt">link =</span> <span class="dv">0</span>)</span>
<span id="cb7-10"><a href="item-response-theory.html#cb7-10"></a></span>
<span id="cb7-11"><a href="item-response-theory.html#cb7-11"></a>threeclass &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb7-12"><a href="item-response-theory.html#cb7-12"></a>                       <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb7-13"><a href="item-response-theory.html#cb7-13"></a>                       <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb7-14"><a href="item-response-theory.html#cb7-14"></a>                       <span class="dt">link =</span> <span class="dv">0</span>)</span>
<span id="cb7-15"><a href="item-response-theory.html#cb7-15"></a></span>
<span id="cb7-16"><a href="item-response-theory.html#cb7-16"></a>fourclass &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S,yv,</span>
<span id="cb7-17"><a href="item-response-theory.html#cb7-17"></a>                       <span class="dt">k =</span> <span class="dv">4</span>,</span>
<span id="cb7-18"><a href="item-response-theory.html#cb7-18"></a>                       <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb7-19"><a href="item-response-theory.html#cb7-19"></a>                       <span class="dt">link =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="item-response-theory.html#cb8-1"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="kw">compare_models</span>(oneclass, twoclass, threeclass, fourclass), </span>
<span id="cb8-2"><a href="item-response-theory.html#cb8-2"></a>                     <span class="dt">title =</span> <span class="st">&quot;Model Comparison&quot;</span>,</span>
<span id="cb8-3"><a href="item-response-theory.html#cb8-3"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb8-4"><a href="item-response-theory.html#cb8-4"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb8-5"><a href="item-response-theory.html#cb8-5"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb8-6"><a href="item-response-theory.html#cb8-6"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Model Comparison</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
log-lik.
</td>
<td>
np
</td>
<td>
BIC
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
model1
</td>
<td>
-3,153.151
</td>
<td>
42
</td>
<td>
6,529.040
</td>
</tr>
<tr>
<td>
model2
</td>
<td>
-2,814.635
</td>
<td>
85
</td>
<td>
6,080.051
</td>
</tr>
<tr>
<td>
model3
</td>
<td>
-2,677.822
</td>
<td>
128
</td>
<td>
6,034.468
</td>
</tr>
<tr>
<td>
model4
</td>
<td>
-2,645.435
</td>
<td>
171
</td>
<td>
6,197.736
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>The model with lowest BIC is retained (i.e. <code>k</code> = 3).</p>
</div>
<div id="define-parameterization-on-link-function" class="section level4">
<h4><span class="header-section-number">11.2.3.2</span> Define parameterization on link function</h4>
<p>To define if Global or local logit shall be used, we need to identify the optimal value of parameter <code>link</code> (1= Glocal logit, 2 = Local logit)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="item-response-theory.html#cb9-1"></a><span class="co">### Check if local or global logit to consider</span></span>
<span id="cb9-2"><a href="item-response-theory.html#cb9-2"></a>global.logit &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb9-3"><a href="item-response-theory.html#cb9-3"></a>                        <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb9-4"><a href="item-response-theory.html#cb9-4"></a>                        <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb9-5"><a href="item-response-theory.html#cb9-5"></a>                        <span class="dt">link =</span> <span class="dv">1</span>, <span class="co"># Global logit</span></span>
<span id="cb9-6"><a href="item-response-theory.html#cb9-6"></a>                        <span class="co"># indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</span></span>
<span id="cb9-7"><a href="item-response-theory.html#cb9-7"></a>                        <span class="dt">disc =</span> <span class="dv">1</span>, </span>
<span id="cb9-8"><a href="item-response-theory.html#cb9-8"></a>                        <span class="co"># indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parameterization)</span></span>
<span id="cb9-9"><a href="item-response-theory.html#cb9-9"></a>                        <span class="dt">difl =</span> <span class="dv">0</span>,</span>
<span id="cb9-10"><a href="item-response-theory.html#cb9-10"></a>                        <span class="dt">multi =</span> <span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(S)))</span>
<span id="cb9-11"><a href="item-response-theory.html#cb9-11"></a></span>
<span id="cb9-12"><a href="item-response-theory.html#cb9-12"></a>local.logit &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb9-13"><a href="item-response-theory.html#cb9-13"></a>                        <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb9-14"><a href="item-response-theory.html#cb9-14"></a>                        <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb9-15"><a href="item-response-theory.html#cb9-15"></a>                        <span class="dt">link =</span> <span class="dv">2</span>, <span class="co"># Local logit</span></span>
<span id="cb9-16"><a href="item-response-theory.html#cb9-16"></a>                        <span class="dt">disc =</span> <span class="dv">1</span>,</span>
<span id="cb9-17"><a href="item-response-theory.html#cb9-17"></a>                        <span class="dt">difl =</span> <span class="dv">0</span>,</span>
<span id="cb9-18"><a href="item-response-theory.html#cb9-18"></a>                        <span class="dt">multi =</span> <span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(S)))</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="item-response-theory.html#cb10-1"></a><span class="co">## Findout if global or local logit is better based on value of BIC</span></span>
<span id="cb10-2"><a href="item-response-theory.html#cb10-2"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="kw">compare_models</span>(global.logit, local.logit), </span>
<span id="cb10-3"><a href="item-response-theory.html#cb10-3"></a>                     <span class="dt">title =</span> <span class="st">&quot;Model Comparison&quot;</span>,</span>
<span id="cb10-4"><a href="item-response-theory.html#cb10-4"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb10-5"><a href="item-response-theory.html#cb10-5"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb10-6"><a href="item-response-theory.html#cb10-6"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb10-7"><a href="item-response-theory.html#cb10-7"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Model Comparison</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
log-lik.
</td>
<td>
np
</td>
<td>
BIC
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
model1
</td>
<td>
-2,726.348
</td>
<td>
72
</td>
<td>
5,834.534
</td>
</tr>
<tr>
<td>
model2
</td>
<td>
-2,741.321
</td>
<td>
72
</td>
<td>
5,864.479
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>The model with lowest BIC is retained (i.e. <code>link</code> = 1).</p>
</div>
<div id="constraints-on-the-item-parameters-likelihood-ratio" class="section level4">
<h4><span class="header-section-number">11.2.3.3</span> Constraints on the item parameters: Likelihood ratio</h4>
<p>To test between nested multidimensional LC IRT models, we can compare different multidimensional model: a restricted model against a larger multidimensional model based on a higher number of dimensions.</p>
<p>A typical example is testing a unidimensional model (and then the hypothesis of unidimensionality) against a bidimensional model through function <code>test_dim</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="item-response-theory.html#cb11-1"></a><span class="co">## Set up the restricted model for the rest of analysis</span></span>
<span id="cb11-2"><a href="item-response-theory.html#cb11-2"></a><span class="co"># # Define matrix to allocate each item to one dimension</span></span>
<span id="cb11-3"><a href="item-response-theory.html#cb11-3"></a>multi2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>),</span>
<span id="cb11-4"><a href="item-response-theory.html#cb11-4"></a>                <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">14</span>))</span>
<span id="cb11-5"><a href="item-response-theory.html#cb11-5"></a></span>
<span id="cb11-6"><a href="item-response-theory.html#cb11-6"></a>unidimensional &lt;-<span class="st"> </span><span class="kw">test_dim</span>(S, yv,</span>
<span id="cb11-7"><a href="item-response-theory.html#cb11-7"></a>                 <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb11-8"><a href="item-response-theory.html#cb11-8"></a>                 </span>
<span id="cb11-9"><a href="item-response-theory.html#cb11-9"></a>     <span class="co"># type of link function (1 = global logits, 2 = local logits); with global logits the Graded Response model results;</span></span>
<span id="cb11-10"><a href="item-response-theory.html#cb11-10"></a>     <span class="co"># with local logits the Partial Credit results (with dichotomous responses, global logits is the same as </span></span>
<span id="cb11-11"><a href="item-response-theory.html#cb11-11"></a>     <span class="co"># using local logits resulting in the Rasch or the 2PL model depending on the value assigned to disc)</span></span>
<span id="cb11-12"><a href="item-response-theory.html#cb11-12"></a>                 <span class="dt">link =</span> <span class="dv">1</span>, </span>
<span id="cb11-13"><a href="item-response-theory.html#cb11-13"></a>     </span>
<span id="cb11-14"><a href="item-response-theory.html#cb11-14"></a>                 <span class="co"># Indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</span></span>
<span id="cb11-15"><a href="item-response-theory.html#cb11-15"></a>                 <span class="dt">disc =</span> <span class="dv">1</span>, </span>
<span id="cb11-16"><a href="item-response-theory.html#cb11-16"></a>     </span>
<span id="cb11-17"><a href="item-response-theory.html#cb11-17"></a>                 <span class="co"># indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parametrization) </span></span>
<span id="cb11-18"><a href="item-response-theory.html#cb11-18"></a>                 <span class="dt">difl =</span> <span class="dv">0</span>,</span>
<span id="cb11-19"><a href="item-response-theory.html#cb11-19"></a>     </span>
<span id="cb11-20"><a href="item-response-theory.html#cb11-20"></a>                 <span class="co"># matrix specifying the multidimensional structure of the restricted model</span></span>
<span id="cb11-21"><a href="item-response-theory.html#cb11-21"></a>                 <span class="dt">multi0 =</span> multi2,  </span>
<span id="cb11-22"><a href="item-response-theory.html#cb11-22"></a>     </span>
<span id="cb11-23"><a href="item-response-theory.html#cb11-23"></a>                 <span class="co"># matrix specifying the multidimensional structure of the larger model</span></span>
<span id="cb11-24"><a href="item-response-theory.html#cb11-24"></a>                 <span class="dt">multi1 =</span> <span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(S)),  </span>
<span id="cb11-25"><a href="item-response-theory.html#cb11-25"></a>     </span>
<span id="cb11-26"><a href="item-response-theory.html#cb11-26"></a>                 <span class="co"># Tolerance level for checking convergence of the algorithm as relative</span></span>
<span id="cb11-27"><a href="item-response-theory.html#cb11-27"></a>                 <span class="co"># difference between consecutive log-likelihoods</span></span>
<span id="cb11-28"><a href="item-response-theory.html#cb11-28"></a>                 <span class="dt">tol =</span> <span class="dv">5</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span>)</span>
<span id="cb11-29"><a href="item-response-theory.html#cb11-29"></a></span>
<span id="cb11-30"><a href="item-response-theory.html#cb11-30"></a>bidimensional &lt;-<span class="st"> </span><span class="kw">test_dim</span>(S, yv,</span>
<span id="cb11-31"><a href="item-response-theory.html#cb11-31"></a>                 <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb11-32"><a href="item-response-theory.html#cb11-32"></a>                 <span class="dt">link =</span> <span class="dv">1</span>,</span>
<span id="cb11-33"><a href="item-response-theory.html#cb11-33"></a>                 <span class="dt">disc =</span> <span class="dv">1</span>,</span>
<span id="cb11-34"><a href="item-response-theory.html#cb11-34"></a>                 <span class="dt">difl =</span> <span class="dv">0</span>,</span>
<span id="cb11-35"><a href="item-response-theory.html#cb11-35"></a>                 <span class="dt">multi1 =</span> multi2,</span>
<span id="cb11-36"><a href="item-response-theory.html#cb11-36"></a>                 <span class="dt">tol =</span> <span class="dv">5</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="item-response-theory.html#cb12-1"></a><span class="kw">summary</span>(unidimensional)</span>
<span id="cb12-2"><a href="item-response-theory.html#cb12-2"></a><span class="kw">summary</span>(bidimensional)</span></code></pre></div>
<p>We will retain here the model with the smaller BIC value - Retained value for <code>link</code> = 1</p>
</div>
<div id="test-of-unidimensionality" class="section level4">
<h4><span class="header-section-number">11.2.3.4</span> Test of unidimensionality</h4>
<p>Once the global logit has been chosen as the best link function, we carry on with the test of unidimensionality.</p>
<p>An LR test is used to comparemodels which differ in terms of the dimensional structure, all other elements being equal (i.e. free item discriminating and difficulty parameters), that is,
* (i) a graded response model (GRM) with an r-dimensional structure,
* (ii) a graded response model (GRM) with a bidimensional structure (i.e., anxiety and depression), as suggested by the structure of the questionnaire, and
* (iii) a graded response model (GRM) with a unidimensional structure (i.e., all the items belong to the same dimension).</p>
<p>For this, models are calculated with different parameters:
* Difficulty levels (Free or Constrained, ie. constant or non-constant) <code>difl</code>.
* Discriminating indices (Free or Constrained, ie. constant or non-constant) <code>disc</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="item-response-theory.html#cb13-1"></a><span class="co"># Unidimensional GRM</span></span>
<span id="cb13-2"><a href="item-response-theory.html#cb13-2"></a>Unidimensional.GradedResponse &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb13-3"><a href="item-response-theory.html#cb13-3"></a>                         <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb13-4"><a href="item-response-theory.html#cb13-4"></a>                         <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb13-5"><a href="item-response-theory.html#cb13-5"></a>                         <span class="dt">link =</span> <span class="dv">1</span>,</span>
<span id="cb13-6"><a href="item-response-theory.html#cb13-6"></a>                         <span class="co"># Indicator of constraints on the discriminating indices ( 1 = free)</span></span>
<span id="cb13-7"><a href="item-response-theory.html#cb13-7"></a>                         <span class="dt">disc =</span> <span class="dv">1</span>,</span>
<span id="cb13-8"><a href="item-response-theory.html#cb13-8"></a>                         <span class="co"># indicator of constraints on the difficulty levels (0 = free) </span></span>
<span id="cb13-9"><a href="item-response-theory.html#cb13-9"></a>                         <span class="dt">difl =</span> <span class="dv">0</span>)</span>
<span id="cb13-10"><a href="item-response-theory.html#cb13-10"></a></span>
<span id="cb13-11"><a href="item-response-theory.html#cb13-11"></a><span class="co"># Unidimensional  RS-GRM rating scale parameterization</span></span>
<span id="cb13-12"><a href="item-response-theory.html#cb13-12"></a>Unidimensional.RatingScale.GradedResponse &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb13-13"><a href="item-response-theory.html#cb13-13"></a>                          <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb13-14"><a href="item-response-theory.html#cb13-14"></a>                          <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb13-15"><a href="item-response-theory.html#cb13-15"></a>                          <span class="dt">link =</span> <span class="dv">1</span>,</span>
<span id="cb13-16"><a href="item-response-theory.html#cb13-16"></a>                          <span class="co"># Indicator of constraints on the discriminating indices ( 1 = free)</span></span>
<span id="cb13-17"><a href="item-response-theory.html#cb13-17"></a>                          <span class="dt">disc =</span> <span class="dv">1</span>,</span>
<span id="cb13-18"><a href="item-response-theory.html#cb13-18"></a>                          <span class="co"># indicator of constraints on the difficulty levels (1 = rating scale parametrization)</span></span>
<span id="cb13-19"><a href="item-response-theory.html#cb13-19"></a>                          <span class="dt">difl =</span> <span class="dv">1</span>) </span>
<span id="cb13-20"><a href="item-response-theory.html#cb13-20"></a><span class="co"># Unidimensional  1P-GRM</span></span>
<span id="cb13-21"><a href="item-response-theory.html#cb13-21"></a>Unidimensional.OneParamater.GradedResponse &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb13-22"><a href="item-response-theory.html#cb13-22"></a>                          <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb13-23"><a href="item-response-theory.html#cb13-23"></a>                          <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb13-24"><a href="item-response-theory.html#cb13-24"></a>                          <span class="dt">link =</span> <span class="dv">1</span>,</span>
<span id="cb13-25"><a href="item-response-theory.html#cb13-25"></a>                          <span class="co"># Indicator of constraints on the discriminating indices (0 = all equal to one)</span></span>
<span id="cb13-26"><a href="item-response-theory.html#cb13-26"></a>                          <span class="dt">disc =</span> <span class="dv">0</span>, </span>
<span id="cb13-27"><a href="item-response-theory.html#cb13-27"></a>                          <span class="co"># indicator of constraints on the difficulty levels (0 = free)</span></span>
<span id="cb13-28"><a href="item-response-theory.html#cb13-28"></a>                          <span class="dt">difl =</span> <span class="dv">0</span>)</span>
<span id="cb13-29"><a href="item-response-theory.html#cb13-29"></a></span>
<span id="cb13-30"><a href="item-response-theory.html#cb13-30"></a><span class="co"># Unidimensional  1P-RS-GRM</span></span>
<span id="cb13-31"><a href="item-response-theory.html#cb13-31"></a>Unidimensional.OneParamater.RatingScale.GradedResponse &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S, yv,</span>
<span id="cb13-32"><a href="item-response-theory.html#cb13-32"></a>                          <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb13-33"><a href="item-response-theory.html#cb13-33"></a>                          <span class="dt">start =</span> <span class="dv">0</span>,</span>
<span id="cb13-34"><a href="item-response-theory.html#cb13-34"></a>                          <span class="dt">link =</span> <span class="dv">1</span>,</span>
<span id="cb13-35"><a href="item-response-theory.html#cb13-35"></a>                          <span class="co"># Indicator of constraints on the discriminating indices (0 = all equal to one)</span></span>
<span id="cb13-36"><a href="item-response-theory.html#cb13-36"></a>                          <span class="dt">disc =</span> <span class="dv">0</span>,</span>
<span id="cb13-37"><a href="item-response-theory.html#cb13-37"></a>                          <span class="co"># indicator of constraints on the difficulty levels (1 = rating scale parametrization)</span></span>
<span id="cb13-38"><a href="item-response-theory.html#cb13-38"></a>                          <span class="dt">difl =</span> <span class="dv">1</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="item-response-theory.html#cb14-1"></a><span class="co"># comparison of RS-GRM and 1P-GRM with GRM</span></span>
<span id="cb14-2"><a href="item-response-theory.html#cb14-2"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="kw">compare_models</span>(Unidimensional.GradedResponse,</span>
<span id="cb14-3"><a href="item-response-theory.html#cb14-3"></a>                                    Unidimensional.RatingScale.GradedResponse,</span>
<span id="cb14-4"><a href="item-response-theory.html#cb14-4"></a>                                    Unidimensional.OneParamater.GradedResponse,</span>
<span id="cb14-5"><a href="item-response-theory.html#cb14-5"></a>                                    <span class="dt">nested =</span> <span class="ot">TRUE</span>), </span>
<span id="cb14-6"><a href="item-response-theory.html#cb14-6"></a>                     <span class="dt">title =</span> <span class="st">&quot;Model Comparison&quot;</span>,</span>
<span id="cb14-7"><a href="item-response-theory.html#cb14-7"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb14-8"><a href="item-response-theory.html#cb14-8"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb14-9"><a href="item-response-theory.html#cb14-9"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb14-10"><a href="item-response-theory.html#cb14-10"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Model Comparison</strong>
</caption>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
log-lik.
</td>
<td>
np
</td>
<td>
BIC
</td>
<td>
LR(vs. model1)
</td>
<td>
df
</td>
<td>
p-value
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
model1
</td>
<td>
-2,731.893
</td>
<td>
59
</td>
<td>
5,776.682
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
model2
</td>
<td>
-2,795.570
</td>
<td>
33
</td>
<td>
5,766.149
</td>
<td>
127.353
</td>
<td>
26
</td>
<td>
0
</td>
</tr>
<tr>
<td>
model3
</td>
<td>
-2,741.285
</td>
<td>
46
</td>
<td>
5,726.521
</td>
<td>
18.782
</td>
<td>
13
</td>
<td>
0.130
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="item-response-theory.html#cb15-1"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="kw">compare_models</span>(Unidimensional.OneParamater.GradedResponse,</span>
<span id="cb15-2"><a href="item-response-theory.html#cb15-2"></a>                                    Unidimensional.OneParamater.RatingScale.GradedResponse,</span>
<span id="cb15-3"><a href="item-response-theory.html#cb15-3"></a>                                    <span class="dt">nested =</span> <span class="ot">TRUE</span>), </span>
<span id="cb15-4"><a href="item-response-theory.html#cb15-4"></a>                     <span class="dt">title =</span> <span class="st">&quot;Model Comparison&quot;</span>,</span>
<span id="cb15-5"><a href="item-response-theory.html#cb15-5"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb15-6"><a href="item-response-theory.html#cb15-6"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb15-7"><a href="item-response-theory.html#cb15-7"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb15-8"><a href="item-response-theory.html#cb15-8"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Model Comparison</strong>
</caption>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
log-lik.
</td>
<td>
np
</td>
<td>
BIC
</td>
<td>
LR(vs. model1)
</td>
<td>
df
</td>
<td>
p-value
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
model1
</td>
<td>
-2,741.285
</td>
<td>
46
</td>
<td>
5,726.521
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
model2
</td>
<td>
-2,844.518
</td>
<td>
20
</td>
<td>
5,795.102
</td>
<td>
206.467
</td>
<td>
26
</td>
<td>
0
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="item-response-theory.html#cb16-1"></a><span class="co">## Unidimensional.OneParamater.GradedResponse has the lowest BIC</span></span>
<span id="cb16-2"><a href="item-response-theory.html#cb16-2"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="kw">rbind</span>(Unidimensional.OneParamater.GradedResponse<span class="op">$</span>Th,</span>
<span id="cb16-3"><a href="item-response-theory.html#cb16-3"></a>                           <span class="dt">prob =</span> Unidimensional.OneParamater.GradedResponse<span class="op">$</span>piv), </span>
<span id="cb16-4"><a href="item-response-theory.html#cb16-4"></a>                     <span class="dt">title =</span> <span class="st">&quot;Model Comparison&quot;</span>,</span>
<span id="cb16-5"><a href="item-response-theory.html#cb16-5"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb16-6"><a href="item-response-theory.html#cb16-6"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb16-7"><a href="item-response-theory.html#cb16-7"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb16-8"><a href="item-response-theory.html#cb16-8"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Model Comparison</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
Class 1
</td>
<td>
Class 2
</td>
<td>
Class 3
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
Dimension 1
</td>
<td>
-0.775
</td>
<td>
1.184
</td>
<td>
3.419
</td>
</tr>
<tr>
<td>
prob
</td>
<td>
0.342
</td>
<td>
0.491
</td>
<td>
0.167
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
</div>
<div id="step-3-items-aggregation-using-the-weights" class="section level3">
<h3><span class="header-section-number">11.2.4</span> Step 3: Items aggregation using the weights</h3>
<p>The discrimination parameters express the informative capacity of a variable and its relative importance within sub-dimensions of the latent variables (as the model is multidimensional): so that the weight of a variable expresses the relative importance of that variable in the dimension it belongs to.</p>
<p>Weights are extracted from discrimination parameters, estimated through a Multidimensional IRT model, using a <code>2PL</code> parametrisation</p>
<p>Two composite indicators can be calculated:</p>
<ul>
<li><strong>Unweighted score</strong> (raw relative frequency of correct response)</li>
<li><strong>Weighted score</strong>, using ˆ γ j (and their transformation) for weighting the items</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="item-response-theory.html#cb17-1"></a><span class="co"># Final model selected Unidimensional GRM</span></span>
<span id="cb17-2"><a href="item-response-theory.html#cb17-2"></a><span class="co"># Estimate the model (say, a bidimensional GRM with 3 latent classes)</span></span>
<span id="cb17-3"><a href="item-response-theory.html#cb17-3"></a>out_GRM &lt;-<span class="st"> </span><span class="kw">est_multi_poly</span>(S,</span>
<span id="cb17-4"><a href="item-response-theory.html#cb17-4"></a>                          yv,</span>
<span id="cb17-5"><a href="item-response-theory.html#cb17-5"></a>                          <span class="dt">link =</span> <span class="dv">1</span>,</span>
<span id="cb17-6"><a href="item-response-theory.html#cb17-6"></a>                          <span class="dt">k =</span> <span class="dv">3</span>,</span>
<span id="cb17-7"><a href="item-response-theory.html#cb17-7"></a>                          <span class="dt">multi =</span> multi2,</span>
<span id="cb17-8"><a href="item-response-theory.html#cb17-8"></a>                          <span class="dt">disc =</span> <span class="dv">1</span>, <span class="co"># Indicator of constraints on the discriminating indices ( 1 = free)</span></span>
<span id="cb17-9"><a href="item-response-theory.html#cb17-9"></a>                          <span class="dt">difl =</span> <span class="dv">0</span>, <span class="co"># indicator of constraints on the difficulty levels (0 = free)</span></span>
<span id="cb17-10"><a href="item-response-theory.html#cb17-10"></a>                          <span class="dt">tol =</span> <span class="dv">10</span><span class="op">^-</span><span class="dv">3</span> )</span></code></pre></div>
<div id="multidimensional-scores" class="section level4">
<h4><span class="header-section-number">11.2.4.1</span> Multidimensional scores</h4>
<p>gamma_hat: <span class="math inline">\(\hat{\gamma}_j\)</span> (weights) from the model selected in the step above.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="item-response-theory.html#cb18-1"></a><span class="co">## `gac` : estimated vector of discriminating item parameters; as this is not a Rasch-type model, values are not constrained to 1;</span></span>
<span id="cb18-2"><a href="item-response-theory.html#cb18-2"></a>gamma_hat &lt;-<span class="st"> </span>out_GRM<span class="op">$</span>gac</span></code></pre></div>
<p>Since two dimensions are supposed, these weights can be divided into two groups</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="item-response-theory.html#cb19-1"></a>dim1 &lt;-<span class="st"> </span>multi2[<span class="dv">1</span>, ] <span class="co">#items of the first dimension</span></span>
<span id="cb19-2"><a href="item-response-theory.html#cb19-2"></a>gamma_hat1 &lt;-<span class="st"> </span>gamma_hat[dim1]</span>
<span id="cb19-3"><a href="item-response-theory.html#cb19-3"></a></span>
<span id="cb19-4"><a href="item-response-theory.html#cb19-4"></a>dim2 &lt;-<span class="st"> </span>multi2[<span class="dv">2</span>, ] <span class="co">#items of the second dimension</span></span>
<span id="cb19-5"><a href="item-response-theory.html#cb19-5"></a>gamma_hat2 &lt;-<span class="st"> </span>gamma_hat[dim2]</span></code></pre></div>
<p>A useful thing to do is to rescale the parameters <strong>(within each dimension)</strong>, so that the most discriminating item (for each dimension) has gamma_hat:<span class="math inline">\(\hat{\gamma}_j = 1\)</span> and the other items have <span class="math inline">\(\hat{\gamma}_j &lt; 1\)</span>. This is obtained by dividing each vector by its maximum element.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="item-response-theory.html#cb20-1"></a><span class="co"># These are the equivalent ones of $\hat{\gamma}_j$ reported in Table 3 of the paper (slide 38 of the presentation &quot;NFER_lect5&quot;). </span></span>
<span id="cb20-2"><a href="item-response-theory.html#cb20-2"></a>gamma_hat1 &lt;-<span class="st"> </span>gamma_hat1<span class="op">/</span><span class="kw">max</span>(gamma_hat1)</span>
<span id="cb20-3"><a href="item-response-theory.html#cb20-3"></a>gamma_hat2 &lt;-<span class="st"> </span>gamma_hat2<span class="op">/</span><span class="kw">max</span>(gamma_hat2)</span></code></pre></div>
<p>We can now use <strong>scaled discriminating item parameters parameters</strong> as weights.</p>
<p>Since these two sets of parameters are dimension-specific so they are not are not comparable.</p>
<p>Two different composite indicators can be constructed at this stage: one for the first dimension (<code>dim1</code>) and one for the second dimension (<code>dim2</code>).</p>
<p>Note that dividing by the weight sum (<code>sum(gamma_hat1)</code>) is not necessary, it depends on the type of indicator you need (in terms of sum or average).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="item-response-theory.html#cb21-1"></a>CI1w &lt;-<span class="st"> </span>(data[, dim1] <span class="op">%*%</span><span class="st"> </span>gamma_hat1) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(gamma_hat1)</span>
<span id="cb21-2"><a href="item-response-theory.html#cb21-2"></a>  </span>
<span id="cb21-3"><a href="item-response-theory.html#cb21-3"></a>CI2w &lt;-<span class="st"> </span>(data[, dim2] <span class="op">%*%</span><span class="st"> </span>gamma_hat2) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(gamma_hat2)</span></code></pre></div>
<p>These indicators can be compared with the unweighted counterpart.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="item-response-theory.html#cb22-1"></a><span class="co">#mean response for each unit</span></span>
<span id="cb22-2"><a href="item-response-theory.html#cb22-2"></a>CI1unw &lt;-<span class="st"> </span><span class="kw">rowSums</span>(data[, dim1])<span class="op">/</span><span class="kw">length</span>(dim1) <span class="co">#=rowMeans(data[,dim1])</span></span>
<span id="cb22-3"><a href="item-response-theory.html#cb22-3"></a></span>
<span id="cb22-4"><a href="item-response-theory.html#cb22-4"></a>CI2unw &lt;-<span class="st"> </span><span class="kw">rowSums</span>(data[, dim2])<span class="op">/</span><span class="kw">length</span>(dim1) <span class="co">#=rowMeans(data[,dim2])</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="item-response-theory.html#cb23-1"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(<span class="kw">head</span>(<span class="kw">data.frame</span>(CI1w, CI1unw, CI2w, CI2unw)), </span>
<span id="cb23-2"><a href="item-response-theory.html#cb23-2"></a>                     <span class="dt">title =</span> <span class="st">&quot;Final Weight&quot;</span>,</span>
<span id="cb23-3"><a href="item-response-theory.html#cb23-3"></a>                     <span class="dt">summary =</span> <span class="ot">FALSE</span>,</span>
<span id="cb23-4"><a href="item-response-theory.html#cb23-4"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb23-5"><a href="item-response-theory.html#cb23-5"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb23-6"><a href="item-response-theory.html#cb23-6"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb23-7"><a href="item-response-theory.html#cb23-7"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Final Weight</strong>
</caption>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
CI1w
</td>
<td>
CI1unw
</td>
<td>
CI2w
</td>
<td>
CI2unw
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
1
</td>
<td>
1.127
</td>
<td>
1.143
</td>
<td>
1.173
</td>
<td>
1.143
</td>
</tr>
<tr>
<td>
2
</td>
<td>
0.576
</td>
<td>
0.571
</td>
<td>
0.715
</td>
<td>
0.714
</td>
</tr>
<tr>
<td>
3
</td>
<td>
1.379
</td>
<td>
1.429
</td>
<td>
0.873
</td>
<td>
0.857
</td>
</tr>
<tr>
<td>
4
</td>
<td>
0.671
</td>
<td>
0.714
</td>
<td>
0.576
</td>
<td>
0.571
</td>
</tr>
<tr>
<td>
5
</td>
<td>
0.279
</td>
<td>
0.286
</td>
<td>
0.432
</td>
<td>
0.429
</td>
</tr>
<tr>
<td>
6
</td>
<td>
0.549
</td>
<td>
0.571
</td>
<td>
0.432
</td>
<td>
0.429
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>Visualisation of resulting composite indicator</p>
<p><img src="vulnerability-scoring_files/figure-html/unnamed-chunk-8-1.png" width="1152" /><img src="vulnerability-scoring_files/figure-html/unnamed-chunk-8-2.png" width="1152" /></p>
</div>
<div id="sinle-composite-indicator" class="section level4">
<h4><span class="header-section-number">11.2.4.2</span> Sinle composite indicator</h4>
<p>One wish to have a unique composite indicator, computed by using the entire response pattern of each unit.</p>
<p>In this case, the discrimination parameters need to be made comparable across dimensions. Then, we have to compute <span class="math inline">\(\gamma_j^*\)</span>.</p>
<p>First, we need to compute gamma_hat: <span class="math inline">\(\hat{\sigma}_d\)</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="item-response-theory.html#cb24-1"></a><span class="co">#`Piv`: optional object of type matrix containing the estimated weights of thelatent classes subject-by-subject  (the weights may be different across subjects in the presence of covariates);</span></span>
<span id="cb24-2"><a href="item-response-theory.html#cb24-2"></a><span class="co">#3 prior probabilities</span></span>
<span id="cb24-3"><a href="item-response-theory.html#cb24-3"></a>piv &lt;-<span class="st"> </span>out_GRM<span class="op">$</span>piv  </span>
<span id="cb24-4"><a href="item-response-theory.html#cb24-4"></a></span>
<span id="cb24-5"><a href="item-response-theory.html#cb24-5"></a><span class="co"># `Th`: estimated matrix of ability levels (support points) for each dimension (= row of matrix Th) and latent class (= column of matrix Th)</span></span>
<span id="cb24-6"><a href="item-response-theory.html#cb24-6"></a><span class="co">#2 x 3 latent traits</span></span>
<span id="cb24-7"><a href="item-response-theory.html#cb24-7"></a>theta &lt;-<span class="st"> </span>out_GRM<span class="op">$</span>Th </span>
<span id="cb24-8"><a href="item-response-theory.html#cb24-8"></a></span>
<span id="cb24-9"><a href="item-response-theory.html#cb24-9"></a>mu_hat &lt;-<span class="st"> </span><span class="kw">c</span>(theta <span class="op">%*%</span><span class="st"> </span>piv) <span class="co"># mean latent traits</span></span>
<span id="cb24-10"><a href="item-response-theory.html#cb24-10"></a>sigma_hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">2</span>) <span class="co">#for each dimension</span></span>
<span id="cb24-11"><a href="item-response-theory.html#cb24-11"></a></span>
<span id="cb24-12"><a href="item-response-theory.html#cb24-12"></a><span class="cf">for</span> (d <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</span>
<span id="cb24-13"><a href="item-response-theory.html#cb24-13"></a>  <span class="co"># Latent trait std.dev.</span></span>
<span id="cb24-14"><a href="item-response-theory.html#cb24-14"></a>  sigma_hat[d] &lt;-<span class="st"> </span><span class="kw">sqrt</span>((theta[d, ] <span class="op">-</span><span class="st"> </span>mu_hat[d])<span class="op">^</span><span class="dv">2</span> <span class="op">%*%</span><span class="st"> </span>piv) </span>
<span id="cb24-15"><a href="item-response-theory.html#cb24-15"></a>}</span>
<span id="cb24-16"><a href="item-response-theory.html#cb24-16"></a></span>
<span id="cb24-17"><a href="item-response-theory.html#cb24-17"></a><span class="co">#sigma_hat</span></span></code></pre></div>
<p>Then, we can compute gamma_hat: <span class="math inline">\(\gamma_j^* = \hat{\sigma}_d \hat{\gamma}_j, j \in \mathcal{J}_d\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="item-response-theory.html#cb25-1"></a>gamma_hat1_star &lt;-<span class="st"> </span>sigma_hat[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>gamma_hat1</span>
<span id="cb25-2"><a href="item-response-theory.html#cb25-2"></a></span>
<span id="cb25-3"><a href="item-response-theory.html#cb25-3"></a>gamma_hat2_star &lt;-<span class="st"> </span>sigma_hat[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>gamma_hat2</span></code></pre></div>
<p>As the standard deviation of the latent traits is taken into consideration, the item discriminations are now comparable.</p>
<p>For example, we could rank the items according to their discrimination.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="item-response-theory.html#cb26-1"></a>item_comp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">item =</span> <span class="kw">c</span>(dim1,dim2),</span>
<span id="cb26-2"><a href="item-response-theory.html#cb26-2"></a>                        <span class="dt">discr =</span> <span class="kw">c</span>(gamma_hat1_star, gamma_hat2_star))</span>
<span id="cb26-3"><a href="item-response-theory.html#cb26-3"></a></span>
<span id="cb26-4"><a href="item-response-theory.html#cb26-4"></a><span class="co"># Item 7 is the least discriminating one, while item 5 is the most discriminating one </span></span>
<span id="cb26-5"><a href="item-response-theory.html#cb26-5"></a></span>
<span id="cb26-6"><a href="item-response-theory.html#cb26-6"></a>allitem &lt;-<span class="st"> </span>item_comp[<span class="kw">order</span>(item_comp<span class="op">$</span>discr), ] </span></code></pre></div>
<p>Hence, a unique composite indicator can be built using these last weights.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="item-response-theory.html#cb27-1"></a>weights_unique &lt;-<span class="st"> </span>item_comp[<span class="kw">order</span>(item_comp<span class="op">$</span>item), <span class="st">&quot;discr&quot;</span>]</span>
<span id="cb27-2"><a href="item-response-theory.html#cb27-2"></a></span>
<span id="cb27-3"><a href="item-response-theory.html#cb27-3"></a>data<span class="op">$</span>CI &lt;-<span class="st"> </span>data <span class="op">%*%</span><span class="st"> </span>weights_unique <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(weights_unique)</span>
<span id="cb27-4"><a href="item-response-theory.html#cb27-4"></a></span>
<span id="cb27-5"><a href="item-response-theory.html#cb27-5"></a><span class="co">#CI</span></span></code></pre></div>
<p>Finally, one could rescale these last parameters (in order to obtain those denoted by <span class="math inline">\(w_j\)</span> in the paper).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="item-response-theory.html#cb28-1"></a>allitem<span class="op">$</span>unique &lt;-<span class="st"> </span>weights_unique<span class="op">/</span><span class="kw">max</span>(weights_unique)</span>
<span id="cb28-2"><a href="item-response-theory.html#cb28-2"></a></span>
<span id="cb28-3"><a href="item-response-theory.html#cb28-3"></a></span>
<span id="cb28-4"><a href="item-response-theory.html#cb28-4"></a>stargazer<span class="op">::</span><span class="kw">stargazer</span>(allitem, </span>
<span id="cb28-5"><a href="item-response-theory.html#cb28-5"></a>                     <span class="dt">title =</span> <span class="st">&quot;Final Weight&quot;</span>,</span>
<span id="cb28-6"><a href="item-response-theory.html#cb28-6"></a>                     <span class="dt">summary =</span> <span class="ot">FALSE</span>,</span>
<span id="cb28-7"><a href="item-response-theory.html#cb28-7"></a>                     <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb28-8"><a href="item-response-theory.html#cb28-8"></a>                     <span class="dt">column.sep.width =</span> <span class="st">&quot;4pt&quot;</span>,</span>
<span id="cb28-9"><a href="item-response-theory.html#cb28-9"></a>                     <span class="dt">align =</span> <span class="ot">TRUE</span>, </span>
<span id="cb28-10"><a href="item-response-theory.html#cb28-10"></a>                     <span class="dt">no.space =</span> <span class="ot">TRUE</span> )</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Final Weight</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
</td>
<td>
item
</td>
<td>
discr
</td>
<td>
unique
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td>
3
</td>
<td>
7
</td>
<td>
0.867
</td>
<td>
0.830
</td>
</tr>
<tr>
<td>
14
</td>
<td>
14
</td>
<td>
1.003
</td>
<td>
0.764
</td>
</tr>
<tr>
<td>
7
</td>
<td>
12
</td>
<td>
1.016
</td>
<td>
0.811
</td>
</tr>
<tr>
<td>
12
</td>
<td>
9
</td>
<td>
1.119
</td>
<td>
0.804
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
<td>
1.128
</td>
<td>
1
</td>
</tr>
<tr>
<td>
2
</td>
<td>
6
</td>
<td>
1.145
</td>
<td>
0.775
</td>
</tr>
<tr>
<td>
10
</td>
<td>
4
</td>
<td>
1.188
</td>
<td>
0.587
</td>
</tr>
<tr>
<td>
9
</td>
<td>
3
</td>
<td>
1.199
</td>
<td>
0.813
</td>
</tr>
<tr>
<td>
4
</td>
<td>
8
</td>
<td>
1.201
</td>
<td>
0.758
</td>
</tr>
<tr>
<td>
5
</td>
<td>
10
</td>
<td>
1.213
</td>
<td>
0.821
</td>
</tr>
<tr>
<td>
8
</td>
<td>
1
</td>
<td>
1.226
</td>
<td>
0.969
</td>
</tr>
<tr>
<td>
13
</td>
<td>
13
</td>
<td>
1.281
</td>
<td>
0.688
</td>
</tr>
<tr>
<td>
6
</td>
<td>
11
</td>
<td>
1.432
</td>
<td>
0.867
</td>
</tr>
<tr>
<td>
11
</td>
<td>
5
</td>
<td>
1.477
</td>
<td>
0.679
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>If the data at issue are multilevel (e.g., refugees nested in different neighborhoods/villages/camps districts), the model can be extended to cluster high-level units (i.e. neighborhoods/villages/camps districts) as well. Further, covariates can be included to check the effects (if any) of individual (or higher level) covariates in the units’ class membership probabilities.</p>
<p>Additionally, Discrete Multidimensional Two-Tier IRT Model, an extension of the previous models can be explored to account for the double dependency of single items on more than one dimension of the Latent Variable.</p>
<p>In further research, the proposed procedure can therefore be extended through a classification of higher-order units in homogeneous groups - instead of ranking them one by one - that would take advantage of the latent class part of the described method, and account for the multilevel structure of the data. So basically not only the analysis would provide the vulnerability score of household but also account for a potential geographic effect within their vulnerability profile.</p>
<p>Another element of research includes to define the impact of sampling on the resulting weights.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-envelopment-and-deprivation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="robustness-and-sensitivity-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/unhcr-americas/vulnerability-scoring/edit/master/10-Item-response-theory.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["vulnerability-scoring.pdf", "vulnerability-scoring.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
